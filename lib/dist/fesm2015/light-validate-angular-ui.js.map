{"version":3,"file":"light-validate-angular-ui.js","sources":["ng://light-validate-angular-ui/src/ui-light-validate/ui-light-validate.directive.ts","ng://light-validate-angular-ui/src/ui-light-validate/ui-light-validate.module.ts"],"sourcesContent":["import { Directive, ElementRef, Input, EventEmitter, Output } from '@angular/core';\nimport { LightException, validate } from 'light-validate';\n\n@Directive({\n  selector: '[UiLightValidate]'\n})\nexport class UiLightValidateDirective {\n\n  @Input('UiLightValidate')\n  public uiLightValidate: any;\n\n  @Input('UiLightProperty')\n  public uiLightProperty: string;\n\n  @Input('UiLightTarget')\n  public uiLightTarget: any;\n\n  @Output('UiLightOnValidate')\n  public uiLightOnValidate: EventEmitter<LightException> = new EventEmitter();\n\n  constructor(private elementRef: ElementRef) {\n\n  }\n\n  public ngOnInit() {\n    this.initialize(this.elementRef.nativeElement);\n  }\n\n  public initialize(el: HTMLElement) {\n\n\n    // criar span que irÃ¡ conter o erro.\n    const htmlErrorElement = this.getHtmlErrorElement(el);\n\n    if (this.isIconEnabled(el)) {\n      // criar div que irÃ¡ conter o icone referente a validaÃ§Ã£o\n      const htmlIconElement = this.getHtmlIconElement(el);\n      !el.parentNode.contains(htmlIconElement) && el.parentNode.insertBefore(htmlIconElement, el);\n    }\n\n    const onValidateThen = () => {\n      //remover span com classe 'error' referente ao campo do DOM...caso jÃ¡ esteja presente\n      el.parentNode.contains(htmlErrorElement) && el.parentNode.removeChild(htmlErrorElement);\n\n      el.parentElement.classList.remove(this.getElementInvalidClass(el));\n      el.parentElement.classList.add(this.getElementValidClass(el));\n\n      //disparar callback externo onValidate\n      this.uiLightOnValidate.emit(null);\n    };\n\n    const onValidateCatch = (errors: LightException[]) => {\n      const error = errors.shift();\n\n      if (error) {\n        //setar texto do span com classe 'error' referente ao campo do DOM...\n        htmlErrorElement.innerHTML = error.code;\n        //adicionar span com classe 'error' referente ao campo do DOM...caso jÃ¡ nÃ£o esteja presente\n        !el.parentNode.contains(htmlErrorElement) && el.parentNode.appendChild(htmlErrorElement);\n        el.parentElement.classList.add(this.getElementInvalidClass(el));\n        el.parentElement.classList.remove(this.getElementValidClass(el));\n\n        //disparar callback externo onValidate\n        this.uiLightOnValidate.emit(error);\n      }\n      else {\n        onValidateThen();\n      }\n    };\n\n    const onValidateFinally = () => {\n\n    }\n\n\n    let firstTrigger: boolean = true;\n    if (this.isValidateOnBlurEnabled(el)) {\n      el.onblur = (event) => {\n        firstTrigger = false;\n        validate(this.uiLightTarget, this.uiLightValidate, this.uiLightProperty)\n          .then(() => onValidateThen())\n          .catch((errors) => onValidateCatch(errors))\n          .finally(() => onValidateFinally());\n      };\n    };\n\n    if (this.isValidateOnChangeEnabled(el)) {\n      el.onchange = (event) => {\n        firstTrigger = false;\n        validate(this.uiLightTarget, this.uiLightValidate, this.uiLightProperty)\n          .then(() => onValidateThen())\n          .catch((errors) => onValidateCatch(errors))\n          .finally(() => onValidateFinally());\n      };\n    }\n\n    if (this.isValidateOnBlurEnabled(el) || this.isValidateOnChangeEnabled(el)) {\n      el.onkeyup = (event) => {\n        const isKeydown = el.getAttribute('modal-rule-keydown');\n        if (!firstTrigger || isKeydown) {\n          validate(this.uiLightTarget, this.uiLightValidate, this.uiLightProperty)\n            .then(() => onValidateThen())\n            .catch((errors) => onValidateCatch(errors))\n            .finally(() => onValidateFinally());\n        }\n      }\n    }\n    else if (this.isValidateOnKeyUpEnabled(el)) {\n      el.onkeyup = (event) => {\n        validate(this.uiLightTarget, this.uiLightValidate, this.uiLightProperty)\n          .then(() => onValidateThen())\n          .catch((errors) => onValidateCatch(errors))\n          .finally(() => onValidateFinally());\n      }\n    };\n  }\n\n  public isValidateOnBlurEnabled(el: HTMLElement) {\n    return this.getBoolValueFromAttr(el, 'ui-light-validate-on-blur', true);\n  }\n\n  public isValidateOnChangeEnabled(el: HTMLElement) {\n    return this.getBoolValueFromAttr(el, 'ui-light-validate-on-change', true);\n  }\n\n  public isValidateOnKeyUpEnabled(el: HTMLElement) {\n    return this.getBoolValueFromAttr(el, 'ui-light-validate-on-keyup', true);\n  }\n\n  public isIconEnabled(el: HTMLElement) {\n    return this.getBoolValueFromAttr(el, 'ui-light-validate-icon-enabled', false);\n  }\n\n  public getElementInvalidClass(el: HTMLElement) {\n    return el.getAttribute('ui-light-validate-invalid-class') || 'light-invalid';\n  }\n\n  public getElementValidClass(el: HTMLElement) {\n    return el.getAttribute('ui-light-validate-valid-class') || 'light-valid';\n  }\n\n  public getElementMessageClass(el: HTMLElement) {\n    return el.getAttribute('ui-light-validate-message-class') || 'light-message';\n  }\n\n  public getBoolValueFromAttr(el: HTMLElement, attr: string, defaultValue: boolean) {\n    if ((el.getAttribute(attr) === undefined || el.getAttribute(attr) === '' || el.getAttribute(attr) === null)) {\n      return defaultValue;\n    }\n    else {\n      return (el.getAttribute(attr) == 'true')\n    }\n  }\n\n\n\n  public getHtmlIconElement(el: HTMLElement) {\n    const htmlDivIconElement: HTMLDivElement = document.createElement('div');\n    htmlDivIconElement.setAttribute('class', 'light-valid-icon');\n    const htmlIconElement: HTMLElement = document.createElement('i');\n    htmlDivIconElement.appendChild(htmlIconElement);\n    return htmlDivIconElement;\n  }\n\n  public getHtmlErrorElement(el: HTMLElement) {\n    const htmlSpanElement: HTMLSpanElement = document.createElement('span');\n    const htmlSpanElementClass = this.getElementMessageClass(el);\n    htmlSpanElement.setAttribute('class', htmlSpanElementClass);\n    return htmlSpanElement;\n  }\n\n\n}\n\n\n","import { UiLightValidateDirective } from './ui-light-validate.directive';\nimport { NgModule } from '@angular/core';\n\n@NgModule({\n  declarations: [UiLightValidateDirective],\n  exports: [UiLightValidateDirective]\n})\nexport class UiLightValidateModule { }\n"],"names":["tslib_1.__decorate"],"mappings":"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"}