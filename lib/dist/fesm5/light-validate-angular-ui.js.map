{"version":3,"file":"light-validate-angular-ui.js","sources":["ng://light-validate-angular-ui/src/ui-light-validate/ui-light-validate.injection-tokens.ts","ng://light-validate-angular-ui/src/ui-light-validate/ui-light-validate.directive.ts","ng://light-validate-angular-ui/src/ui-light-validate/ui-light-validate.module.ts","ng://light-validate-angular-ui/light-validate-angular-ui.ts"],"sourcesContent":["import { UiLightValidateResolver } from './ui-light-validate.resolver';\nimport { InjectionToken } from '@angular/core';\n\nexport const RESOLVER = new InjectionToken<UiLightValidateResolver>('ui-light-validate.resolver');\nexport const MAPPINGS = new InjectionToken<UiLightValidateResolver>('ui-light-validate.mappings');\n","import { Directive, ElementRef, Input, EventEmitter, Output, Inject } from '@angular/core';\nimport { LightException, validate } from 'light-validate';\nimport { RESOLVER, MAPPINGS } from './ui-light-validate.injection-tokens';\nimport { UiLightValidateResolver } from './ui-light-validate.resolver';\n\n@Directive({\n  selector: '[UiLightValidate]'\n})\nexport class UiLightValidateDirective {\n\n  @Input('UiLightValidate')\n  public validate: any;\n\n  @Input('UiLightProperty')\n  public property: string;\n\n  @Input('UiLightTarget')\n  public target: any;\n\n  @Output('UiLightOnValidate')\n  public onValidate: EventEmitter<LightException> = new EventEmitter();\n\n  constructor(\n    @Inject(RESOLVER) private resolver: UiLightValidateResolver,\n    @Inject(MAPPINGS) private mappings: Array<any>,\n    private el: ElementRef\n  ) {\n  }\n\n  public ngOnInit() {\n    this.initialize(this.el.nativeElement);\n  }\n\n  public initialize(el: HTMLElement) {\n\n\n    // criar span que irÃ¡ conter o erro.\n    const htmlErrorElement = this.getHtmlErrorElement(el);\n\n    if (this.isIconEnabled(el)) {\n      // criar div que irÃ¡ conter o icone referente a validaÃ§Ã£o\n      const htmlIconElement = this.getHtmlIconElement(el);\n      !el.parentNode.contains(htmlIconElement) && el.parentNode.insertBefore(htmlIconElement, el);\n    }\n\n    const onValidateThen = () => {\n      //remover span com classe 'error' referente ao campo do DOM...caso jÃ¡ esteja presente\n      el.parentNode.contains(htmlErrorElement) && el.parentNode.removeChild(htmlErrorElement);\n\n      el.parentElement.classList.remove(this.getElementInvalidClass(el));\n      el.parentElement.classList.add(this.getElementValidClass(el));\n\n      //disparar callback externo onValidate\n      this.onValidate.emit(null);\n    };\n\n    const onValidateCatch = (exceptions: LightException[]) => {\n      const exception = exceptions.shift();\n\n      if (exception) {\n        //setar texto do span com classe 'error' referente ao campo do DOM...\n        htmlErrorElement.innerHTML = this.resolver ? this.resolver.label(exception) : exception.code;\n        //adicionar span com classe 'error' referente ao campo do DOM...caso jÃ¡ nÃ£o esteja presente\n        !el.parentNode.contains(htmlErrorElement) && el.parentNode.appendChild(htmlErrorElement);\n        el.parentElement.classList.add(this.getElementInvalidClass(el));\n        el.parentElement.classList.remove(this.getElementValidClass(el));\n\n        //disparar callback externo onValidate\n        this.onValidate.emit(exception);\n      }\n      else {\n        onValidateThen();\n      }\n    };\n\n    const onValidateFinally = () => {\n\n    }\n\n\n    let firstTrigger: boolean = true;\n    if (this.isValidateOnBlurEnabled(el)) {\n      el.onblur = (event) => {\n        firstTrigger = false;\n        validate(this.target, this.validate, this.property)\n          .then(() => onValidateThen())\n          .catch((errors) => onValidateCatch(errors))\n          .finally(() => onValidateFinally());\n      };\n    };\n\n    if (this.isValidateOnChangeEnabled(el)) {\n      el.onchange = (event) => {\n        firstTrigger = false;\n        validate(this.target, this.validate, this.property)\n          .then(() => onValidateThen())\n          .catch((errors) => onValidateCatch(errors))\n          .finally(() => onValidateFinally());\n      };\n    }\n\n    if (this.isValidateOnBlurEnabled(el) || this.isValidateOnChangeEnabled(el)) {\n      el.onkeyup = (event) => {\n        const isKeydown = el.getAttribute('modal-rule-keydown');\n        if (!firstTrigger || isKeydown) {\n          validate(this.target, this.validate, this.property)\n            .then(() => onValidateThen())\n            .catch((errors) => onValidateCatch(errors))\n            .finally(() => onValidateFinally());\n        }\n      }\n    }\n    else if (this.isValidateOnKeyUpEnabled(el)) {\n      el.onkeyup = (event) => {\n        validate(this.target, this.validate, this.property)\n          .then(() => onValidateThen())\n          .catch((errors) => onValidateCatch(errors))\n          .finally(() => onValidateFinally());\n      }\n    };\n  }\n\n  public isValidateOnBlurEnabled(el: HTMLElement) {\n    return this.getBoolValueFromAttr(el, 'ui-light-validate-on-blur', true);\n  }\n\n  public isValidateOnChangeEnabled(el: HTMLElement) {\n    return this.getBoolValueFromAttr(el, 'ui-light-validate-on-change', true);\n  }\n\n  public isValidateOnKeyUpEnabled(el: HTMLElement) {\n    return this.getBoolValueFromAttr(el, 'ui-light-validate-on-keyup', true);\n  }\n\n  public isIconEnabled(el: HTMLElement) {\n    return this.getBoolValueFromAttr(el, 'ui-light-validate-icon-enabled', false);\n  }\n\n  public getMapping(mapping: any, mappings: Array<any> = []) {\n    return typeof mapping === 'string' ? mappings.find(m => m.name === mapping) : mapping;\n  }\n\n  public getElementInvalidClass(el: HTMLElement) {\n    return el.getAttribute('ui-light-validate-invalid-class') || 'light-invalid';\n  }\n\n  public getElementValidClass(el: HTMLElement) {\n    return el.getAttribute('ui-light-validate-valid-class') || 'light-valid';\n  }\n\n  public getElementMessageClass(el: HTMLElement) {\n    return el.getAttribute('ui-light-validate-message-class') || 'light-message';\n  }\n\n  public getBoolValueFromAttr(el: HTMLElement, attr: string, defaultValue: boolean) {\n    if ((el.getAttribute(attr) === undefined || el.getAttribute(attr) === '' || el.getAttribute(attr) === null)) {\n      return defaultValue;\n    }\n    else {\n      return (el.getAttribute(attr) == 'true')\n    }\n  }\n\n\n\n  public getHtmlIconElement(el: HTMLElement) {\n    const htmlDivIconElement: HTMLDivElement = document.createElement('div');\n    htmlDivIconElement.setAttribute('class', 'light-valid-icon');\n    const htmlIconElement: HTMLElement = document.createElement('i');\n    htmlDivIconElement.appendChild(htmlIconElement);\n    return htmlDivIconElement;\n  }\n\n  public getHtmlErrorElement(el: HTMLElement) {\n    const htmlSpanElement: HTMLSpanElement = document.createElement('span');\n    const htmlSpanElementClass = this.getElementMessageClass(el);\n    htmlSpanElement.setAttribute('class', htmlSpanElementClass);\n    return htmlSpanElement;\n  }\n\n\n}\n\n\n","import { ModuleWithProviders, NgModule } from '@angular/core';\nimport { UiLightValidateDirective } from './ui-light-validate.directive';\nimport { RESOLVER, MAPPINGS } from './ui-light-validate.injection-tokens';\nimport { UiLightValidateResolver } from './ui-light-validate.resolver';\nimport { UiLightValidateConfig } from './ui-light-validate.coonfig';\n\n@NgModule({\n  declarations: [UiLightValidateDirective],\n  exports: [UiLightValidateDirective],\n  providers: [\n    { provide: RESOLVER, useValue: undefined },\n    { provide: MAPPINGS, useValue: undefined }\n  ]\n})\nexport class UiLightValidateModule {\n  public static forRoot(\n    config: Partial<UiLightValidateConfig>\n  ): ModuleWithProviders {\n    return {\n      ngModule: UiLightValidateModule,\n      providers: [\n        { provide: RESOLVER, useValue: config.resolver },\n        { provide: MAPPINGS, useValue: config.mappings }\n      ]\n    }\n  }\n}\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './public_api';\n\nexport {MAPPINGS as Éµb,RESOLVER as Éµa} from './src/ui-light-validate/ui-light-validate.injection-tokens';\nexport {UiLightValidateResolver as Éµc} from './src/ui-light-validate/ui-light-validate.resolver';"],"names":["tslib_1.__decorate","tslib_1.__param"],"mappings":"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"}